<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Financial Decision-Making Toolkit</title>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; max-width: 1000px; margin: 0 auto; background-color: #f0f4f8; }
        .container { background-color: #ffffff; padding: 30px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1, h2, h3 { color: #2c3e50; }
        input, button { margin: 10px 0; padding: 10px; width: 100%; box-sizing: border-box; border: 1px solid #bdc3c7; border-radius: 5px; }
        button { background-color: #3498db; color: white; border: none; cursor: pointer; transition: background-color 0.3s; }
        button:hover { background-color: #2980b9; }
        #results { margin-top: 30px; border-top: 2px solid #ecf0f1; padding-top: 20px; }
        .instructions, .sample-data { background-color: #ecf0f1; padding: 20px; border-radius: 5px; margin-bottom: 20px; }
        .chart-container { width: 100%; max-width: 600px; margin: 20px auto; }
        .metric-card { background-color: #f9f9f9; border-radius: 5px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .metric-card h4 { margin-top: 0; color: #34495e; }
        .narrative { background-color: #e8f4fd; padding: 20px; border-radius: 5px; margin-top: 30px; border-left: 5px solid #3498db; }
    </style>
</head>
<body>
    <div class="container">
        <h1>AI-Powered Financial Decision-Making Toolkit</h1>
        
        <div class="instructions">
            <h2>Instructions</h2>
            <ol>
                <li>Enter your financial data for the last 6 months in each field, separating the values with commas.</li>
                <li>For each field (Revenue, COGS, Operating Expenses, Cash Flow), input 6 numeric values.</li>
                <li>If you want to analyze a potential loan, enter the loan amount, annual interest rate (as a percentage), and loan term in months.</li>
                <li>Click the "Run Analysis" button to see the results.</li>
                <li>Review the visual charts, key metrics, and narrative summary to gain insights into your financial situation.</li>
            </ol>
        </div>

        <div class="sample-data">
            <h2>Sample Dataset</h2>
            <p>You can use this sample data to test the toolkit:</p>
            <ul>
                <li>Revenue: 50000, 52000, 51000, 53000, 55000, 54000</li>
                <li>COGS: 20000, 21000, 20500, 21500, 22000, 21800</li>
                <li>Operating Expenses: 15000, 15500, 15200, 15800, 16000, 15900</li>
                <li>Cash Flow: 10000, 10500, 10200, 10700, 11000, 10800</li>
                <li>Loan Amount: 100000</li>
                <li>Annual Interest Rate: 5</li>
                <li>Loan Term (months): 60</li>
            </ul>
        </div>
        
        <h2>Input Financial Data</h2>
        <p>Enter your financial data for the last 6 months, separated by commas:</p>
        <input type="text" id="revenue" placeholder="Revenue (e.g., 50000,52000,51000,53000,55000,54000)">
        <input type="text" id="cogs" placeholder="Cost of Goods Sold">
        <input type="text" id="operatingExpenses" placeholder="Operating Expenses">
        <input type="text" id="cashFlow" placeholder="Cash Flow">
        
        <h2>Loan Analysis</h2>
        <input type="number" id="loanAmount" placeholder="Loan Amount">
        <input type="number" id="interestRate" placeholder="Annual Interest Rate (%)">
        <input type="number" id="loanTerm" placeholder="Loan Term (months)">
        
        <br><br>
        <button id="runAnalysisButton">Run Analysis</button>
        
        <div id="results">
            <div class="chart-container">
                <!-- Predefined canvas element for Chart.js -->
                <canvas id="projectionsChart"></canvas>
            </div>
        </div>
    </div>

    <script>
    // Financial Toolkit JavaScript Code

    const FinancialDecisionToolkit = {
        data: {
            revenue: [],
            cogs: [],
            operatingExpenses: [],
            cashFlow: []
        },

        inputData(newData) {
            Object.keys(newData).forEach(key => {
                if (Array.isArray(newData[key])) {
                    this.data[key] = newData[key];
                }
            });
        },

        generateProjections(months = 6) {
            const forecast = (data) => {
                const n = data.length;
                const sum_x = (n * (n + 1)) / 2;
                const sum_y = data.reduce((a, b) => a + b, 0);
                const sum_xy = data.reduce((sum, y, i) => sum + y * (i + 1), 0);
                const sum_xx = (n * (n + 1) * (2 * n + 1)) / 6;

                const m = (n * sum_xy - sum_x * sum_y) / (n * sum_xx - sum_x * sum_x);
                const b = (sum_y - m * sum_x) / n;

                return Array(months).fill().map((_, i) => m * (n + i + 1) + b);
            };

            return {
                revenueForecast: forecast(this.data.revenue),
                cogsForecast: forecast(this.data.cogs),
                expensesForecast: forecast(this.data.operatingExpenses),
                cashFlowForecast: forecast(this.data.cashFlow)
            };
        },

        performRiskAssessment() {
            const baseRevenue = this.data.revenue[this.data.revenue.length - 1];
            const baseCOGS = this.data.cogs[this.data.cogs.length - 1];
            const baseExpenses = this.data.operatingExpenses[this.data.operatingExpenses.length - 1];
            const scenarios = [
                { name: 'Best Case', revenueChange: 0.1 },
                { name: 'Most Likely', revenueChange: 0.05 },
                { name: 'Worst Case', revenueChange: -0.05 }
            ];

            return scenarios.map(scenario => {
                const projectedRevenue = baseRevenue * (1 + scenario.revenueChange);
                const projectedCOGS = baseCOGS * (1 + scenario.revenueChange * 0.8);
                const projectedExpenses = baseExpenses * (1 + scenario.revenueChange * 0.5);
                const netIncome = projectedRevenue - projectedCOGS - projectedExpenses;
                const cashFlow = netIncome * 0.8;
                return {
                    scenario: scenario.name,
                    projectedRevenue,
                    projectedNetIncome: netIncome,
                    projectedCashFlow: cashFlow
                };
            });
        },

        getRecommendations() {
            const latestCashFlow = this.data.cashFlow[this.data.cashFlow.length - 1];
            return {
                expansionInvestments: latestCashFlow * 0.4,
                debtRepayment: latestCashFlow * 0.3,
                emergencyFunds: latestCashFlow * 0.3
            };
        },

        analyzeLoanOption(loanAmount, annualInterestRate, loanTermMonths) {
            const monthlyRate = annualInterestRate / 12 / 100;
            const monthlyPayment = (loanAmount * monthlyRate * Math.pow(1 + monthlyRate, loanTermMonths)) / 
                                   (Math.pow(1 + monthlyRate, loanTermMonths) - 1);
            const totalCost = monthlyPayment * loanTermMonths;
            return {
                monthlyPayment,
                totalCost,
                totalInterest: totalCost - loanAmount
            };
        }
    };

    function runAnalysis() {
        // Get input values
        const revenue = document.getElementById('revenue').value.split(',').map(Number);
        const cogs = document.getElementById('cogs').value.split(',').map(Number);
        const operatingExpenses = document.getElementById('operatingExpenses').value.split(',').map(Number);
        const cashFlow = document.getElementById('cashFlow').value.split(',').map(Number);

        const loanAmount = Number(document.getElementById('loanAmount').value);
        const interestRate = Number(document.getElementById('interestRate').value);
        const loanTerm = Number(document.getElementById('loanTerm').value);

        // Input data to the toolkit
        FinancialDecisionToolkit.inputData({ revenue, cogs, operatingExpenses, cashFlow });

        // Generate results
        const projections = FinancialDecisionToolkit.generateProjections();
        const riskAssessment = FinancialDecisionToolkit.performRiskAssessment();
        const recommendations = FinancialDecisionToolkit.getRecommendations();
        const loanAnalysis = FinancialDecisionToolkit.analyzeLoanOption(loanAmount, interestRate, loanTerm);

        // Display results
        let resultsHtml = '<h2>Analysis Results</h2>';

        // Projections Chart
        resultsHtml += '<div class="chart-container"><canvas id="projectionsChart"></canvas></div>';

        // Key Metrics
        resultsHtml += '<h3>Key Metrics</h3>';
        resultsHtml += '<div class="metric-card">';
        resultsHtml += `<h4>Revenue Growth</h4>`;
        const revenueGrowth = ((projections.revenueForecast[projections.revenueForecast.length - 1] - revenue[revenue.length - 1]) / revenue[revenue.length - 1] * 100).toFixed(2);
        resultsHtml += `<p>Projected 6-month growth: ${revenueGrowth}%</p>`;
        resultsHtml += '</div>';

        resultsHtml += '<div class="metric-card">';
        resultsHtml += `<h4>Profit Margin</h4>`;
        const latestRevenue = revenue[revenue.length - 1];
        const latestCOGS = cogs[cogs.length - 1];
        const latestExpenses = operatingExpenses[operatingExpenses.length - 1];
        const profitMargin = ((latestRevenue - latestCOGS - latestExpenses) / latestRevenue * 100).toFixed(2);
        resultsHtml += `<p>Current: ${profitMargin}%</p>`;
        resultsHtml += '</div>';

        // Risk Assessment
        resultsHtml += '<h3>Risk Assessment</h3>';
        riskAssessment.forEach(scenario => {
            resultsHtml += `<div class="metric-card">`;
            resultsHtml += `<h4>${scenario.scenario}</h4>`;
            resultsHtml += `<p>Projected Revenue: $${scenario.projectedRevenue.toFixed(2)}</p>`;
            resultsHtml += `<p>Projected Net Income: $${scenario.projectedNetIncome.toFixed(2)}</p>`;
            resultsHtml += `<p>Projected Cash Flow: $${scenario.projectedCashFlow.toFixed(2)}</p>`;
            resultsHtml += `</div>`;
        });

        // Capital Allocation Recommendations
        resultsHtml += '<h3>Capital Allocation Recommendations</h3>';
        resultsHtml += '<div class="metric-card">';
        resultsHtml += `<p>Expansion Investments: $${recommendations.expansionInvestments.toFixed(2)}</p>`;
        resultsHtml += `<p>Debt Repayment: $${recommendations.debtRepayment.toFixed(2)}</p>`;
        resultsHtml += `<p>Emergency Funds: $${recommendations.emergencyFunds.toFixed(2)}</p>`;
        resultsHtml += '</div>';

        // Loan Analysis
        if (loanAmount && interestRate && loanTerm) {
            resultsHtml += '<h3>Loan Analysis</h3>';
            resultsHtml += '<div class="metric-card">';
            resultsHtml += `<p>Monthly Payment: $${loanAnalysis.monthlyPayment.toFixed(2)}</p>`;
            resultsHtml += `<p>Total Cost of Loan: $${loanAnalysis.totalCost.toFixed(2)}</p>`;
            resultsHtml += `<p>Total Interest Paid: $${loanAnalysis.totalInterest.toFixed(2)}</p>`;
            resultsHtml += '</div>';
        }

        // Narrative Summary
        resultsHtml += '<div class="narrative">';
        resultsHtml += '<h3>Financial Journey: Your Business Story</h3>';
        resultsHtml += `<p>Over the past 6 months, your business has generated revenues ranging from $${Math.min(...revenue).toLocaleString()} to $${Math.max(...revenue).toLocaleString()}. Your profit margin currently stands at ${profitMargin}%, indicating how efficiently you're turning revenue into profit.</p>`;
        resultsHtml += `<p>Looking ahead, we project a ${revenueGrowth}% change in revenue over the next 6 months. This suggests that your business is ${revenueGrowth >= 0 ? 'poised for growth' : 'facing potential challenges'} in the near future.</p>`;
        resultsHtml += `<p>In our risk assessment:</p>`;
        resultsHtml += `<ul>`;
        riskAssessment.forEach(scenario => {
            resultsHtml += `<li><strong>${scenario.scenario}:</strong> Projected Revenue: $${scenario.projectedRevenue.toFixed(2)}, Net Income: $${scenario.projectedNetIncome.toFixed(2)}, Cash Flow: $${scenario.projectedCashFlow.toFixed(2)}</li>`;
        });
        resultsHtml += `</ul>`;
        resultsHtml += `<p>Based on your latest cash flow of $${cashFlow[cashFlow.length - 1].toLocaleString()}, we recommend allocating funds towards expansion, debt repayment, and emergency reserves to strengthen your financial position.</p>`;
        resultsHtml += '</div>';

        // Append the results to the DOM
        document.getElementById('results').innerHTML = resultsHtml;

        // Generate the projections chart
        const ctx = document.getElementById('projectionsChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: [...Array(projections.revenueForecast.length).keys()].map(i => `Month ${i + 1}`),
                datasets: [{
                    label: 'Revenue Forecast',
                    data: projections.revenueForecast,
                    borderColor: 'rgba(52, 152, 219, 1)',
                    backgroundColor: 'rgba(52, 152, 219, 0.2)',
                    fill: false,
                }]
            },
            options: {
                responsive: true,
            }
        });
    }

    // Attach event listener to the button
    document.getElementById('runAnalysisButton').addEventListener('click', runAnalysis);
    </script>
</body>
</html>
